import{Ba as P,C as w,D as a,E as T,Ia as S,Ja as V,L as x,La as E,Ma as U,N as c,Na as C,P as i,Q as o,R as g,U as d,V as l,W as u,aa as r,ba as k,ca as M,ja as y,o as v,s as p,t as _,va as I}from"./chunk-DKADGSXX.js";import"./chunk-SZXJF6TW.js";import{i as f}from"./chunk-P2VZOJAX.js";function H(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u();return _(e.irAUsuarios())}),r(1,"Usuarios"),o()}}function O(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u();return _(e.irAInformes())}),r(1,"Informes"),o()}}function A(n,m){n&1&&g(0,"div",11)}function L(n,m){if(n&1){let t=d();i(0,"div",12)(1,"p"),r(2,"No hay sesi\xF3n activa."),o(),i(3,"button",13),l("click",function(){p(t);let e=u();return _(e.goToLogin())}),i(4,"strong"),r(5,"Iniciar sesi\xF3n"),o()(),g(6,"br")(7,"br"),i(8,"button",14)(9,"strong"),r(10,"Registro"),o()()()}}function F(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u(2);return _(e.irATurnos())}),r(1,"Mis Turnos"),o()}}function D(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u(2);return _(e.irASolicitarTurnos())}),r(1,"Solicitar Turno"),o()}}function R(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u(2);return _(e.irAMiPerfil())}),r(1,"Mi Perfil"),o()}}function j(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u(2);return _(e.irATurnos())}),r(1,"Mis Turnos"),o()}}function z(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u(2);return _(e.irAMiPerfil())}),r(1,"Mi Perfil"),o()}}function N(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u(2);return _(e.irAPacientes())}),r(1,"Pacientes"),o()}}function q(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u(2);return _(e.irATurnos())}),r(1,"Administrar Turnos"),o()}}function B(n,m){if(n&1){let t=d();i(0,"button",10),l("click",function(){p(t);let e=u(2);return _(e.irASolicitarTurnos())}),r(1,"Solicitar Turno"),o()}}function K(n,m){if(n&1&&(i(0,"div",15)(1,"p",16),r(2,"Sesi\xF3n iniciada como: "),i(3,"strong"),r(4),o(),r(5),o(),i(6,"div",17),x(7,F,2,0,"button",2)(8,D,2,0,"button",2)(9,R,2,0,"button",2)(10,j,2,0,"button",2)(11,z,2,0,"button",2)(12,N,2,0,"button",2)(13,q,2,0,"button",2)(14,B,2,0,"button",2),o()()),n&2){let t=u();a(4),k(t.tipoUsuario||"Usuario"),a(),M(" \u2014 ",t.userEmail," "),a(2),c("ngIf",t.tipoUsuario==="paciente"),a(),c("ngIf",t.tipoUsuario==="paciente"),a(),c("ngIf",t.tipoUsuario==="paciente"),a(),c("ngIf",t.tipoUsuario==="especialista"),a(),c("ngIf",t.tipoUsuario==="especialista"),a(),c("ngIf",t.tipoUsuario==="especialista"),a(),c("ngIf",t.tipoUsuario==="administrador"),a(),c("ngIf",t.tipoUsuario==="administrador")}}var b=U(C.apiUrl,C.publicAnonKey),$=(()=>{class n{constructor(t){this.router=t,this.userEmail=null,this.isLoggedIn=!1,this.esAdmin=!1,this.tipoUsuario=null,this.cargandoUsuarios=!1}ngOnInit(){return f(this,null,function*(){yield this.checkSession(),this.isLoggedIn&&(yield this.loadUserType())})}checkSession(){return f(this,null,function*(){let{data:{session:t}}=yield b.auth.getSession();t?(this.isLoggedIn=!0,this.userEmail=t.user.email??null):(this.isLoggedIn=!1,this.userEmail=null,this.esAdmin=!1,this.tipoUsuario=null)})}loadUserType(){return f(this,null,function*(){let{data:{session:t}}=yield b.auth.getSession();if(!t)return;let s=t.user.id,{data:e,error:h}=yield b.from("usuarios").select("tipo_usuario").eq("id",s).single();if(h||!e){console.error("Error al obtener tipo_usuario:",h?.message),this.esAdmin=!1,this.tipoUsuario=null;return}this.tipoUsuario=e.tipo_usuario,this.esAdmin=e.tipo_usuario==="administrador"})}logout(){b.auth.signOut().then(()=>{this.isLoggedIn=!1,this.userEmail=null,this.esAdmin=!1,this.tipoUsuario=null,this.router.navigate(["/login"])}).catch(t=>{console.error("Error al cerrar sesi\xF3n:",t.message)})}goToLogin(){this.router.navigate(["/login"])}irAUsuarios(){this.cargandoUsuarios=!0,setTimeout(()=>{this.router.navigate(["/usuarios"])},700)}irAInformes(){this.cargandoUsuarios=!0,setTimeout(()=>{this.router.navigate(["/informes"])},700)}irATurnos(){this.router.navigate(["/turnos"])}irASolicitarTurnos(){this.router.navigate(["/solicitar-turno"])}irAMiPerfil(){this.router.navigate(["/mi-perfil"])}irAPacientes(){this.router.navigate(["/pacientes"])}static{this.\u0275fac=function(s){return new(s||n)(T(S))}}static{this.\u0275cmp=v({type:n,selectors:[["app-home"]],standalone:!0,features:[y],decls:17,vars:5,consts:[[1,"home-container"],[1,"top-buttons"],["class","nav-button",3,"click",4,"ngIf"],["class","spinner",4,"ngIf"],[1,"divider"],[1,"title"],["class","login-section",4,"ngIf"],["class","user-info",4,"ngIf"],[1,"logout-button",3,"click"],["href",w`https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap`,"rel","stylesheet"],[1,"nav-button",3,"click"],[1,"spinner"],[1,"login-section"],[1,"login-button",3,"click"],["routerLink","/register",1,"login-button"],[1,"user-info"],[1,"inline-session"],[1,"button-row"]],template:function(s,e){s&1&&(i(0,"div",0)(1,"div",1),x(2,H,2,0,"button",2)(3,O,2,0,"button",2)(4,A,1,0,"div",3),o(),g(5,"hr",4)(6,"br"),i(7,"h1",5),r(8,"\u{1F3E5} Cl\xEDnica Online"),o(),g(9,"hr",4),x(10,L,11,0,"div",6)(11,K,15,10,"div",7),g(12,"br"),i(13,"button",8),l("click",function(){return e.logout()}),i(14,"strong"),r(15,"Cerrar sesi\xF3n"),o()()(),g(16,"link",9)),s&2&&(a(2),c("ngIf",e.esAdmin&&!e.cargandoUsuarios),a(),c("ngIf",e.esAdmin&&!e.cargandoUsuarios),a(),c("ngIf",e.cargandoUsuarios),a(6),c("ngIf",!e.isLoggedIn),a(),c("ngIf",e.isLoggedIn))},dependencies:[P,I,E,V],styles:[`.home-container[_ngcontent-%COMP%]{font-family:Poppins,Segoe UI,sans-serif;padding:60px 20px;display:flex;flex-direction:column;align-items:center;min-height:100vh;background-color:#ccc8ad;background-image:url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M 0 0 L 40 40 M 40 0 L 0 40' stroke='%23c5e1a5' stroke-width='0.5'/%3E%3C/svg%3E")}.title[_ngcontent-%COMP%]{font-size:3rem;font-weight:600;color:#2e7d32;margin-bottom:16px;text-align:center}.divider[_ngcontent-%COMP%]{height:1px;width:80%;background-color:#9bffb6;border:none}.top-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;gap:12px;margin-bottom:32px}.nav-button[_ngcontent-%COMP%], .login-button[_ngcontent-%COMP%], .logout-button[_ngcontent-%COMP%]{background-color:#e9f5ea;color:#2e7d32;border:1px solid transparent;padding:12px 24px;border-radius:12px;font-size:1rem;font-weight:500;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 6px #0000000f;white-space:nowrap;flex-shrink:0}.nav-button[_ngcontent-%COMP%]:hover, .login-button[_ngcontent-%COMP%]:hover, .logout-button[_ngcontent-%COMP%]:hover{background-color:#c8e6c9;color:#1b5e20;transform:translateY(-2px);box-shadow:0 4px 10px #0000001a}.login-section[_ngcontent-%COMP%], .user-info[_ngcontent-%COMP%]{background-color:#fff4f44c;border-radius:16px;padding:30px 24px;margin-top:32px;width:100%;max-width:900px;text-align:center;box-shadow:0 6px 24px #0000000d;color:#1b5e20}.inline-session[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:24px;font-size:1.05rem}.button-row[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;justify-content:center;gap:16px;overflow-x:auto;padding-bottom:16px}.spinner[_ngcontent-%COMP%]{border:5px solid #e0f2e9;border-top:5px solid #81c784;border-radius:50%;width:48px;height:48px;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-top:40px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.user-info[_ngcontent-%COMP%]{max-width:100%;padding:24px 16px}.inline-session[_ngcontent-%COMP%]{white-space:normal}.button-row[_ngcontent-%COMP%]{flex-wrap:wrap;gap:12px;justify-content:center}.nav-button[_ngcontent-%COMP%], .login-button[_ngcontent-%COMP%], .logout-button[_ngcontent-%COMP%]{width:100%;margin:8px 0}}`]})}}return n})();export{$ as HomeComponent};
