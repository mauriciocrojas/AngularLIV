import{a as S,b as R,c as F,d as W,e as L}from"./chunk-YMCCSRAY.js";import{a as O,b as u}from"./chunk-BKKPCO3N.js";import"./chunk-5PDZ6P5C.js";import{A as i,D as m,E as M,F as d,H as w,I as g,J as c,K as p,M as v,S as y,T as E,W as k,X as P,h as b,s as l,t as x,w as _,x as C,z as o}from"./chunk-RC6RUPVX.js";import{h}from"./chunk-RS6LHQUM.js";function I(s,z){if(s&1&&(o(0,"div",10),d(1),i()),s&2){let e=M();l(),w(" ",e.errorMessage," ")}}var f=O(u.apiUrl,u.publicAnonKey),K=(()=>{class s{constructor(e){this.router=e,this.name="",this.age=0,this.avatarFile=null,this.errorMessage=null,this.username="",this.password=""}register(){this.errorMessage=null,f.auth.signUp({email:this.username,password:this.password}).then(({data:e,error:r})=>{r?(console.error("Error en el registro:",r.message),this.errorMessage=this.translateError(r.message)):(console.log("Usuario registrado:",e.user),this.saveUserData(e.user))})}saveUserData(e){console.log("Guardando datos del usuario..."),this.saveFile().then(r=>{r?(console.log("Avatar subido correctamente:",r),f.from("users-data").insert([{authId:e.id,name:this.name,age:this.age,avatarUrl:r.path}]).then(({data:t,error:a})=>{a?console.error("Error al guardar en users-data:",a.message):(console.log("Datos de usuario guardados correctamente en users-data:",t),this.router.navigate(["/home"]))})):console.error("Error al subir el archivo del avatar")})}saveFile(){return h(this,null,function*(){if(!this.avatarFile)return console.error("No se ha seleccionado un archivo de avatar."),null;let{data:e,error:r}=yield f.storage.from("images").upload(`users/${this.avatarFile.name}`,this.avatarFile,{cacheControl:"3600",upsert:!1});return r?(console.error("Error al subir el archivo:",r.message),null):e})}onFileSelected(e){this.avatarFile=e.target.files[0]}translateError(e){let r={"Email already registered":"El correo electr\xF3nico ya est\xE1 registrado.","Invalid email":"El correo electr\xF3nico no es v\xE1lido.","Password too weak":"La contrase\xF1a es demasiado d\xE9bil.","Invalid password":"La contrase\xF1a no es v\xE1lida.","Invalid credentials":"Credenciales inv\xE1lidas.","Email not confirmed":"El correo electr\xF3nico no ha sido confirmado."};return e.toLowerCase().includes("user already registered")||e.toLowerCase().includes("email already registered")?"El correo electr\xF3nico ya est\xE1 registrado.":r[e]||"Ocurri\xF3 un error inesperado. Por favor, intenta de nuevo."}static{this.\u0275fac=function(r){return new(r||s)(x(k))}}static{this.\u0275cmp=b({type:s,selectors:[["app-register"]],standalone:!0,features:[v],decls:14,vars:5,consts:[[1,"register-container"],["type","text","placeholder","Email",1,"register-input",3,"ngModelChange","ngModel"],["type","password","placeholder","Password",1,"register-input",3,"ngModelChange","ngModel"],["type","text","placeholder","Nombre",1,"register-input",3,"ngModelChange","ngModel"],["type","number","placeholder","Edad",1,"register-input",3,"ngModelChange","ngModel"],["type","file",1,"register-input",3,"change"],[1,"btn",3,"click"],["class","error-message",4,"ngIf"],[1,"login-link-container"],["routerLink","/login",1,"btn"],[1,"error-message"]],template:function(r,t){r&1&&(o(0,"div",0)(1,"h3"),d(2,"Registro"),i(),o(3,"input",1),p("ngModelChange",function(n){return c(t.username,n)||(t.username=n),n}),i(),o(4,"input",2),p("ngModelChange",function(n){return c(t.password,n)||(t.password=n),n}),i(),o(5,"input",3),p("ngModelChange",function(n){return c(t.name,n)||(t.name=n),n}),i(),o(6,"input",4),p("ngModelChange",function(n){return c(t.age,n)||(t.age=n),n}),i(),o(7,"input",5),m("change",function(n){return t.onFileSelected(n)}),i(),o(8,"button",6),m("click",function(){return t.register()}),d(9," Registrar "),i(),_(10,I,2,1,"div",7),o(11,"div",8)(12,"button",9),d(13," Ir al Login "),i()()()),r&2&&(l(3),g("ngModel",t.username),l(),g("ngModel",t.password),l(),g("ngModel",t.name),l(),g("ngModel",t.age),l(4),C("ngIf",t.errorMessage))},dependencies:[L,S,W,R,F,P,E,y],styles:[".register-container[_ngcontent-%COMP%]{background-color:#000;color:#fff;padding:20px;border-radius:8px;width:100%;max-width:400px;margin:20px auto;box-sizing:border-box;box-shadow:0 0 15px #ff4081}h3[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:20px;text-align:center;color:#000;text-shadow:0 0 5px #f44336,0 0 10px #f44336,0 0 15px #f44336,0 0 20px #ff4081,0 0 30px #ff4081,0 0 40px #ff4081,0 0 50px #ff4081,0 0 60px #ff4081}.register-input[_ngcontent-%COMP%]{width:100%;padding:10px 15px;margin-bottom:15px;border-radius:5px;border:1px solid #ff9b9b;background-color:#333;color:#fff;box-sizing:border-box;font-size:1rem;transition:all .3s ease}.register-input[_ngcontent-%COMP%]:focus{border-color:#f44336;box-shadow:0 0 8px #f44336}.btn[_ngcontent-%COMP%]{width:100%;padding:10px;background-color:#dc0000;color:#400;border:1px solid #fff;border-radius:17px;cursor:pointer;font-size:1.2rem;margin-top:10px;box-sizing:border-box;box-shadow:0 0 10px #f3de21;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover{background-color:#f3c221;color:#000;transform:scale(1.05)}.btn-link[_ngcontent-%COMP%]{display:block;width:100%;padding:10px;background-color:#333;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:1rem;text-align:center;text-decoration:none;margin-top:10px;box-sizing:border-box}.btn-link[_ngcontent-%COMP%]:hover{background-color:#444}.login-link-container[_ngcontent-%COMP%]{text-align:center;margin-top:0}.error-message[_ngcontent-%COMP%]{color:#ff4081;font-size:1rem;margin-top:10px;text-align:center;font-weight:700;box-shadow:0 0 8px #ff4081}"]})}}return s})();export{K as RegisterComponent};
